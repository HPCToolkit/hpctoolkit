<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--
  HPCToolkit Documentation: Editing within Netscape/Mozilla Composer
  is possible, but it generates strange stuff in-line.  
  Please use an ordinary text editor.
-->

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

  <title>HPCToolkit: Downloading, Building and Installing</title>

  <link rel='stylesheet' type='text/css' href='styleForAll.css'>
</head>

<body>

<!-- ********************************************************************** -->

<script language="JavaScript" src="header_hpctoolkit.js"></script>

<!-- ********************************************************************** -->

<div id="main">

<!-- automatically updated by Emacs hook below; nicer than CVS Date -->
<p class="lastupdated">Last Updated: 2004-10-28</p>

<a name="toc"></a>
<h2>Building and Installing HPCToolkit</h2>

<h2>Contents</h2>
<ul>

  <li>Building and Installing
  <ul>
    <li><a href="#build_overview">Build Overview</a>
    <li><a href="#build_xlib_binutils">External Library: GNU binutils</a>
    <li><a href="#build_xlib_xercesc">External Library: Xerces-C++</a>
    <li><a href="#build_xlib_oa">External Library: OpenAnalysis</a>
    <li><a href="#build_hpctoolkit">HPCToolkit</a>
  </ul>

  <li><a href="#build_troubleshooting">Build Troubleshooting</a>
  
</ul>

<!-- ********************************************************************** -->
<!-- ********************************************************************** -->

<h2>Building and Installing</h2>
<p><i>[<a href="#toc">Contents</a>]</i>

<div class="indent">

<!-- ********************************************************************** -->

<a name="build_overview"></a>

<h2>Build Overview</h2>
<p><i>[<a href="#toc">Contents</a>]</i>


<p>There are three external libraries -- OpenAnalysis, Xerces-C++ and
GNU binutils -- that must be built before HPCToolkit can be built,
installed and used.  Please use the same C++ compiler for each
component.</p>

<!-- ********************************************************************** -->

<a name="build_xlib_binutils"></a>

<h2>External Library: GNU binutils</h2>
<p><i>[<a href="#toc">Contents</a>]</i>


<h3>Notes</h3>

<p>Most of the C compilers listed in 
<a href="building.html#prerequisites">System Prerequisites</a> 
can compile binutils.  Below is a list of exceptions or
special options.</p>

<ul>
  <li>GCC C 2.9x can also be used.
  <li>ia64-Linux:
    <ul class="noindent">
      <li>Intel C 6.x or 7.x <i>cannot</i> be used; use GCC C.
    </ul>
  <li>mips-IRIX64:
    <ul class="noindent">
      <li>SGI C <i>cannot</i> be used; use GCC C.
      <li>GCC C should be run with <code>-mabi=64</code>, e.g.,
         <code>CFLAGS='-O -mabi=64'</code>.
    </ul>
</ul>


<h3>Building</h3>

<ol class="noindent">

<li>
<p>Change to the top-level binutils directory <code>binutils</code>.

<li>
<p>Configure, build and install.  Run make with the C compiler (CC)
and compilation options (CFLAGS).  Since this will produce a lot of
output, you may want to redirect it to a file.  For example:

<div class="indent">
  <code>gmake CC='gcc' CFLAGS='-O'</code><br>
</div>

<li>
<p>(Optional) Clean the build files.  

<div class="indent">
  <code>gmake clean</code><br>
</div>

<!--
The second command will remove unnecessary <i>installed</i> binutils
tools.
  <code>gmake minimize_install</code>
-->

</ol>


<!-- ********************************************************************** -->

<a name="build_xlib_xercesc"></a>

<h2>External Library: Xerces-C++</h2>
<p><i>[<a href="#toc">Contents</a>]</i>

<h3>Notes</h3>

<p>Below is a list of special options for compiling Xerces-C++.

<ul>
  <li>mips-IRIX64:
    <ul class="noindent">
      <li>SGI C++ should be compiled with <code>-64</code>:
         <code>CXXFLAGS='-64'</code>.
      <li>GCC C++ should be compiled with <code>-mabi=64</code>:
         <code>CXXFLAGS='-mabi=64'</code>.
    </ul>
</ul>


<h3>Building</h3>

<ol class="noindent">

<li>
<p>Change to the top-level Xerces-C++ directory <code>xercesc</code>.

<li>
<p>Configure, build and install.  Run make with the C++ and C compiler
(CXX and CC, respectively) and compilation options (CXXFLAGS).  Since
this will produce a lot of output, you may want to redirect it to a
file.  For example:

<div class="indent">
  <code>gmake CXX='g++' CC='gcc' CXXFLAGS=''</code><br>
</div>

<li>
<p>(Optional) Clean the build files.

<div class="indent">
  <code>gmake clean</code>
</div>

</ol>


<!-- ********************************************************************** -->

<a name="build_xlib_oa"></a>

<h2>External Library: OpenAnalysis</h2>
<p><i>[<a href="#toc">Contents</a>]</i>


<h3>Notes</h3>

<p>Below is a list of special options for compiling OpenAnalysis.

<ul>
  <li>mips-IRIX64:
    <ul class="noindent">
      <li>SGI C++ should be compiled with <code>-64</code>:
         <code>CXXFLAGS='-O -64'</code>.
      <li>GCC C++ should be compiled with <code>-mabi=64</code>:
         <code>CXXFLAGS='-O -mabi=64'</code>.
    </ul>
</ul>


<h3>Building</h3>

<ol class="noindent">

<li>
<p>Change to the top-level OpenAnalysis directory <code>OpenAnalysis</code>.

<li>
<p>Configure, build and install.  Run make with the C++ compiler (CXX)
and compilation options (CXXFLAGS).  Since this will produce a lot of
output, you may want to redirect it to a file.  For example:

<div class="indent">
  <code>gmake CXX='g++' CXXFLAGS='-O'</code><br>
</div>

<li>
<p>(Optional) Clean the build files.

<div class="indent">
  <code>gmake clean</code>
</div>

</ol>


<!-- ********************************************************************** -->

<a name="build_hpctoolkit"></a>

<h2>HPCToolkit</h2>
<p><i>[<a href="#toc">Contents</a>]</i>

<h3>Building</h3>

<p>The easiest way to build HPCToolkit is to use
<code>Makefile.quick</code>.  If you want to build <a
href="hpcrun.html" class="hpctool">hpcrun</a>, you will need to use
the <code>PAPI</code> option.  For a brief description, list of
supported options and the default installation path, execute the
following.

<div class="indent">
  <code>make -f Makefile.quick help</code><br>
</div>

<ol class="noindent">

<li>
<p>Change to the top-level HPCToolkit directory <code>HPCToolkit</code>.

<li>
<p>Configure, build and install.  Run make with the C++ compiler (CXX)
and C compiler (CC).  Since this will produce a lot of output, you may
want to redirect it to a file.  For example:

<div class="indent">
  <code>gmake -f Makefile.quick [PAPI=&lt;install_path&gt;] CXX='g++' CC='gcc'</code><br>
</div>

</ol>

<p>This will build and install HPCToolkit in the paths given above.
Because the installation is compact and self-contained, you may rename
or move it to another location.  All source code may be removed.


<!-- ********************************************************************** -->

</div>

<!-- end: Building -->

<!-- ********************************************************************** -->
<!-- ********************************************************************** -->

<a name="build_troubleshooting"></a>

<h2>Troubleshooting</h2>
<p><i>[<a href="#toc">Contents</a>]</i>


<ol class="noindent">

<li>
<p>GNU binutils will not build.  For addition information go to the
binutils <a href="http://sources.redhat.com/binutils">website</a>.</p>

<!-- http://www.gnu.org/software/binutils/ -->


<li>
<p>When compiling OpenAnalysis with GCC 3.0.4 and <code>-0</code>, there is a
compilation error similar to:</p>

<div class="indent">
  <pre>DomTree.C:73: Internal compiler error in expand_end_loop, at stmt.c:2527</pre>
</div>

<p>OpenAnalysis exposes a bug in the GCC 3.0.4 optimizer.  Turn off
optimization and recompile.</p>


<li>
<p>When linking HPCToolkit, there is an error message similar to:

<div class="indent">
  <pre>undefined reference to `__udivsi3'</pre>
</div>

<p>Most likely you compiled GNU binutils with GCC and are compiling
HPCToolkit with a non-GCC compiler.  Unfortunately, sometimes the GNU
binutils libraries are not fully self-contained, and lack some symbols
that are defined in <code>libgcc.a</code> or <code>libgcc_s.so</code>
(depending on which compiler version you have).  

<p>There are two solutions to this problem.  First, you can compile
HPCToolkit with GCC and the appropriate library will be automatically
provided during the linking stage.  Secondly, you can continue
compiling with a non-GCC compiler while adding the appropriate library
to the link line.  To do this, first determine which library your
version of GCC uses.  Then, open the file
<code>${HPCTOOLKIT}/src/Makeinclude.config.${HPCTOOLKIT_PLATFORM}</code>
in an editor and modify the <code>USER_C_LDFLAGS</code> variable.  For
example, the lines below would add <code>libgcc.a</code> or
<code>libgcc_s.so</code>, respectively, to the link:

<div class="indent">
  <code>USER_C_LDFLAGS = /gcc_lib_path/libgcc.a</code><br>
  <code>USER_C_LDFLAGS = /gcc_lib_path/libgcc_s.so</code>
</div>

</ol>


<!-- ********************************************************************** -->
<!-- ********************************************************************** -->

<script language="JavaScript" src="footer_hpctoolkit.js"></script>

<!-- ********************************************************************** -->

</div> <!-- id=main -->

</body>
</html>


<!-- Local Variables: -->
<!-- eval: (add-hook 'write-file-hooks 'time-stamp) -->
<!-- time-stamp-start: ">Last Updated: " -->
<!-- time-stamp-format: "%:y-%02m-%02d" -->
<!-- time-stamp-end: "<" -->
<!-- time-stamp-line-limit: 35 -->
<!-- End: -->

