%% $Id$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[english]{article}
\usepackage[latin1]{inputenc}
\usepackage{babel}
\usepackage{verbatim}

%% do we have the `hyperref package?
\IfFileExists{hyperref.sty}{
   \usepackage[bookmarksopen,bookmarksnumbered]{hyperref}
}{}

%% do we have the `fancyhdr' or `fancyheadings' package?
\IfFileExists{fancyhdr.sty}{
\usepackage[fancyhdr]{latex2man}
}{
\IfFileExists{fancyheadings.sty}{
\usepackage[fancy]{latex2man}
}{
\usepackage[nofancy]{latex2man}
\message{no fancyhdr or fancyheadings package present, discard it}
}}

%% do we have the `rcsinfo' package?
\IfFileExists{rcsinfo.sty}{
\usepackage[nofancy]{rcsinfo}
\rcsInfo $Id$
\setDate{\rcsInfoLongDate}
}{
\setDate{ 2007/06/29}
\message{package rcsinfo not present, discard it}
}

\setVersionWord{Version:}  %%% that's the default, no need to set it.
\setVersion{=PACKAGE_VERSION=}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{Name}{1}{hpcprof}{The HPCToolkit Performance Tools}{The HPCToolkit Performance Tools}{hpcprof:\\ Simple correlation of flat profiles with source code}

\Prog{hpcprof} correlates `flat' execution profiles with source code files, procedures, lines or with object code.
It is typically used to generate plain-text or HTML output.
The code is derived from Curtis Janssen's VProf.

\end{Name}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Synopsis}

\Prog{hpcprof} \oOpt{options} \Arg{binary} \Arg{hpcrun-file}...

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Description}

\Prog{hpcprof} correlates `flat' execution profiles of \Arg{binary} with source code files, procedures, lines or with object code.
It is typically used to generate plain-text or HTML output.
\Arg{hpcrun-file} is a collection of event-based program counter histograms obtained using \Cmd{hpcrun}{1} (or \Cmd{hpcex}{1}).

\Prog{hpcprof} can generate the following information.  Note that the term \emph{native} event refers to an event for which there is a program counter histogram.  
\begin{Description}
  \item[totals] Total sample counts for each native event, over each load module.  If the same native event name appears more than once, min/max/sum \emph{derived} events are computed.
  \item[load-module correlation] For each \emph{native} event (in order), show the exclusive percentage (or number) of samples attributed to each load module in the \Arg{hpcrun-file}s.  
Percentages are relative to totals.
  \item[file correlation] For each \emph{native} event (in order), show the exclusive percentage (or number) of samples attributed to each $<$load module$>$$<$source file$>$ pair.  
Percentages are relative to totals.
  \item[function correlation] For each \emph{native} event (in order), show the exclusive percentage (or number) of samples attributed to each $<$load module$>$$<$function$>$ pair.
Percentages are relative to totals.
  \item[line correlation] For each \emph{native} event (in order), show the exclusive percentage (or number) of samples attributed to each $<$load module$>$$<$file$>$$<$line$>$ triple.
Percentages are relative to totals.
  \item[annotated source files] For each $<$load module$>$$<$source file$>$ pair, annotate the file's source lines with line correlation information.
  \item[object code correlation] For each \emph{native} event (in order), show the exclusive percentage (or number) of samples attributed to each (text segment) object code instruction from each load module.
Percentages annotating an instruction are relative to that procedure.
By default, only procedures where some event has a count greater than 0 are shown.
NOTE: On ISA's with variable sized instructions, histogram buckets (4 bytes in size) may contain information for more than one instruction.  In this case, multiple instructions will report counts for the \emph{same} bucket.
\end{Description}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Arguments}

\begin{Description}
\item[\Arg{binary}] An executable binary.
\item[\Arg{hpcrun-file}...] A non-empty list of \Arg{hpcrun-file}s.
\end{Description}

Default values for an option's optional arguments are shown in \{\}.

\subsection{Options: General}

\begin{Description}
\item[\OptArg{-d}{dir}, \OptArg{--directory}{dir}] Search \Arg{dir} for source files.
\item[\OptArg{-D}{dir}, \OptArg{--recursive-directory}{dir}] Search \Arg{dir} recursively for source files.
\item[\Opt{--force}] Show data that is not accurate.
\item[\Opt{-V}, \Opt{--version}] Print version information.
\item[\Opt{-h}, \Opt{--help}] Print help.
\item[\OptArg{--debug}{n}]   Debug: use debug level \Arg{n}.
\end{Description}

\subsection{Options: Plain-text and HTML Output}
\begin{Description}
  \item[\Opt{-e}, \Opt{--everything}] load-module, file, function, line correlations, and annotated source files.
  \item[\Opt{-f}, \Opt{--files}] Show file correlation described above.
  \item[\Opt{-r}, \Opt{--funcs}] Show function correlation described above.
  \item[\Opt{-l}, \Opt{--lines}] Show line correlation described above.
  \item[\OptArg{-a}{file}, \OptArg{--annotate}{file}] Show annotated source file \Arg{file}.  (Note that \Arg{file} must match the string contained in the binary's debugging file tables.)

  \item[\Opt{-o}, \Opt{--object}] Show object code correlation (plain-text only).  Use the \Opt{-l}, \Opt{--lines} option to intermingle source line information with object code.
  \item[\Opt{--othreshold}] Show only object procedures with an event count greater than or equal to \Arg{n}.  \{1\}\  (Use 0 to see all procedures).

  \item[\Opt{-n}, \Opt{--number}] Show number of samples instead of percentage
  \item[\OptArg{-s}{n}, \OptArg{--show}{n}] Use threshold \Arg{n} for showing aggregate data
  \item[\OptArg{-H}{dir}, \OptArg{--html}{dir}] Output HTML into directory \Arg{dir}
\end{Description}

\subsection{Options: PROFILE Output}
\begin{Description}
  \item[\Opt{-p}, \Opt{--profile}] Generate PROFILE output to stdout. Note: This option is deprecated; use \Cmd{hpcquick}{1}/\Cmd{hpcview}{1} for improved correlation.
\end{Description}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Examples}

\begin{itemize}

\item Assume we have collected flat profiling information using \Cmd{hpcrun}{1} \Cmd{hpcex}{1}).
Let the binary and profile be named \File{poissonSolve} and \File{poissonSolve.PAPI_L2_DCM-etc...}, respectively.
Assume further that we wish to correlate the profile with source lines.
To do this, execute:
\begin{verbatim}
    hpcprof -l poissonSolve sweep3dsingle poissonSolve.PAPI_L2_DCM-etc...
\end{verbatim}

\item Using the same example as above, assume we wish to correlate the profile with object code.  Execute the following command:
\begin{verbatim}
    hpcprof -o poissonSolve sweep3dsingle poissonSolve.PAPI_L2_DCM-etc...
\end{verbatim}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Notes}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{See Also}

\Cmd{hpctoolkit}{1}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Version}

Version: \Version\ of \Date.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{License and Copyright}

\begin{description}
\item[Copyright] \copyright\ 2002-2007, Rice University.
\item[License] See \File{README.License}.
\end{description}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Authors}

\noindent
Nathan Tallent \\
John Mellor-Crummey \\
Rob Fowler \\
Email: \Email{hpc@cs.rice.edu} \\
WWW: \URL{http://hipersoft.cs.rice.edu/hpctoolkit}.

\LatexManEnd

\end{document}

%% Local Variables:
%% eval: (add-hook 'write-file-hooks 'time-stamp)
%% time-stamp-start: "setDate{ "
%% time-stamp-format: "%:y/%02m/%02d"
%% time-stamp-end: "}\n"
%% time-stamp-line-limit: 50
%% End:

